# vibe coding 象棋指导棋（Coach-mode Xiangqi）
## 产品需求文档 PRD v0.1

---

## 1. 项目背景与动机

### 1.1 个人动机
用户在与室友下中国象棋时，经常在开局或中局阶段被快速（约 10 步左右）击败，暴露出基础战术意识不足、对对方威胁判断不清的问题。

### 1.2 市场现状问题
现有主流中国象棋软件或网站通常存在以下问题：
- 只给出 **一个推荐走法（best move）**
- 当用户选择非推荐走法时，**缺乏分析或完全不分析**
- 赛后复盘以引擎分数为主，**缺少教学式解释**

### 1.3 产品机会
借助「象棋引擎 + LLM」，构建一个真正 **像人类教练一样** 的实时指导棋系统：

> 不管你下什么棋，AI 都会告诉你：  
> **你这步下得怎么样、错在哪、为什么、还能怎么下。**

---

## 2. 产品愿景（Vision）

打造一个 **面向入门 / 初级棋手的实时象棋私教**，帮助用户：

- 在对局中即时理解「为什么这步不好 / 好」
- 建立正确的下棋思维顺序  
  **先看将军 → 再看威胁 → 再谈计划**
- 显著减少低级失误和“被速杀”

**一句话定义：**

> 一个会陪你下棋、边下边教、赛后还能总结你问题的象棋 AI 教练。

---

## 3. 目标用户与使用场景

### 3.1 目标用户
- 中国象棋新手 / 入门级玩家
- 会基本规则，但常见问题包括：
  - 漏看将军
  - 贪子
  - 子力不协调
  - 不清楚每步的目的

### 3.2 核心使用场景
1. **实时指导对局**
   - 用户每走一步，AI 自动分析
2. **犯错即时纠正**
   - 即使下了非推荐手，也能获得完整解释
3. **赛后复盘学习**
   - 总结整局关键失误与改进方向

---

## 4. 核心差异化

| 维度         | 现有象棋软件 | 本产品         |
| ------------ | ------------ | -------------- |
| 非推荐走法   | 基本无分析   | ✅ 完整分析     |
| 推荐走法数量 | 1 个         | ✅ 2~3 个       |
| 解释方式     | 引擎数值     | ✅ 人类教练语言 |
| 教学目标     | 赢棋         | ✅ 建立思维     |
| 赛后复盘     | 简单统计     | ✅ 错误总结     |

---

## 5. MVP 功能范围

### 5.1 棋盘与走子
- 标准中国象棋棋盘（9 × 10）
- 用户手动走子（红方）
- MVP 阶段可不做联网对战

### 5.2 每步实时分析（核心功能）

用户每走一步后，系统自动输出：

#### （1）本步评价
- 等级：  
  **好棋 / 可下 / 软着 / 失误 / 致命失误**
- 一句话原因说明

#### （2）危险提示（必须项）
- 是否漏看：
  - 将军
  - 捉子
  - 杀棋
- 给出对方最强惩罚走法（用于前端高亮）

#### （3）改进建议（2~3 个）
- 每个建议都包含：
  - 走法
  - 目的（防守 / 出子 / 简化 / 进攻）
  - 简短主变（1~2 步）

### 5.3 前端可视化指导
- 红色箭头：对方最强反击
- 绿色箭头：推荐替代方案
- 点击推荐走法即可自动落子

### 5.4 赛后复盘总结
- 本局 2~3 个关键转折点
- 用户最主要的 1~2 类错误
- 下一局的单点训练建议

---

## 6. 非目标（MVP 不做）

- 排位 / 段位系统
- 社交 / 匹配对战
- 题库系统
- 商业化 / 订阅

---

## 7. 体验与交互原则

1. **任何走法都有反馈**
2. **先给结论，再给解释**
3. **默认简短，可展开**
4. **始终强调对方威胁**

---

## 8. 技术方案概览（高层）

### 8.1 技术栈（初版假设）
- 后端：Python + FastAPI
- 象棋引擎：独立进程（UCI / 自定义协议）
- LLM：教学解释与总结
- 通信：HTTP / WebSocket

### 8.2 职责分离
- **引擎负责**
  - 合法走法
  - 局面评估
  - 最佳 / 候选走法
- **LLM 负责**
  - 教学式解释
  - 错误归因
  - 学习建议

---

## 9. 核心数据结构（概念）

### 9.1 坐标系统
- 内部统一：`a0 ~ i9`
- 与前端棋盘像素一一映射

### 9.2 单步分析输出示例
```json
{
  "verdict": "mistake",
  "one_line": "这步忽略了对方将军，直接丢车。",
  "danger": {
    "move": {"from": "e7", "to": "e4"},
    "reason": "形成将军并攻击中路。"
  },
  "alternatives": [
    {"from": "h0", "to": "h3", "reason": "先防将军"},
    {"from": "b0", "to": "b2", "reason": "出子稳住局面"}
  ]
}