# vibe coding 象棋指导棋
## v1.0.0 功能需求说明（FSD）

---

## 1. 文档目的

本文件定义 **v1.0.0 版本的功能需求范围**，目标是实现一个：

> **规则完整、可正常对弈、稳定可扩展的中国象棋基础对战系统**

该版本不包含 AI、不包含分析、不包含教学，仅作为后续版本的技术与规则基础。

---

## 2. 版本目标（v1.0.0）

### 2.1 核心目标

- 能完整地下完一盘中国象棋
- 所有走子符合中国象棋规则
- 能正确判断：
  - 将军
  - 将死
  - 对局结束

### 2.2 非目标（本版本明确不做）

- ❌ AI / 引擎
- ❌ 走法分析
- ❌ 复盘
- ❌ 网络对战
- ❌ 教学提示

---

## 3. 使用场景

### 3.1 基本对局流程

1. 初始化标准中国象棋棋盘
2. 红方先行
3. 双方轮流走子
4. 系统校验每一步是否合法
5. 出现将死时，对局结束

---

## 4. 功能需求

### 4.1 棋盘（Board）

#### 4.1.1 棋盘规格
- 尺寸：9 列 × 10 行
- 坐标系统：
  - 列：`a ~ i`
  - 行：`0 ~ 9`
- 内部统一使用 `a0 ~ i9` 表示棋盘位置

#### 4.1.2 棋盘职责
- 保存当前棋子分布
- 提供查询接口：
  - 查询某坐标的棋子
  - 判断坐标是否在棋盘内

---

### 4.2 棋子（Piece）

#### 4.2.1 棋子类型
- 帅 / 将
- 士
- 象 / 相
- 马
- 车
- 炮
- 兵 / 卒

#### 4.2.2 棋子属性
- 类型（type）
- 阵营（red / black）
- 当前坐标

---

### 4.3 走子规则（Move Rules）

系统必须 **严格实现中国象棋官方规则**。

#### 4.3.1 基础要求
- 所有走子必须：
  - 在棋盘范围内
  - 符合该棋子的移动规则
  - 不允许越子（除炮规则外）

#### 4.3.2 各棋子规则要求（摘要）

> 具体实现允许拆分到规则模块中

- **帅 / 将**
  - 只能在九宫内移动
  - 不能“将帅对脸”
- **士**
  - 九宫内斜走一步
- **象 / 相**
  - 走“田”字
  - 不能过河
  - 象眼不可被堵
- **马**
  - 走“日”字
  - 马腿不可被堵
- **车**
  - 横竖直线行走
  - 不可越子
- **炮**
  - 不吃子：不可越子
  - 吃子：必须隔一子
- **兵 / 卒**
  - 过河前只能前进
  - 过河后可左右移动
  - 不可后退

---

### 4.4 合法性校验（Move Validation）

系统在每次走子前，必须校验：

1. 起点存在棋子
2. 棋子阵营与当前行动方一致
3. 目标位置走法合法
4. 走子后 **己方帅 / 将不处于被将军状态**

若校验失败，走子必须被拒绝。

---

### 4.5 将军与胜负判定

#### 4.5.1 将军检测
- 在每次走子后：
  - 判断对方帅 / 将是否处于被攻击状态
- 系统需能识别：
  - 普通将军
  - 炮将
  - 马将等

#### 4.5.2 将死判定
- 当一方被将军，且：
  - 无任何合法走子可以解除将军
- 判定为 **将死**
- 对局结束

---

### 4.6 对局状态管理（Game State）

系统需要维护以下状态：

- 当前棋盘状态
- 当前行动方（red / black）
- 对局是否结束
- 胜负结果（red win / black win）

---

## 5. 非功能性需求

### 5.1 稳定性
- 不允许出现非法状态
- 不允许“走到一半规则崩溃”

### 5.2 可扩展性
- 规则模块应可复用：
  - 后续接入引擎
  - 后续做走法分析
- 不将 AI / 分析逻辑耦合进规则层

---

## 6. 验收标准（Definition of Done）

v1.0.0 被认为完成，当且仅当：

- ✅ 能完整下完一盘棋
- ✅ 所有非法走子都会被拒绝
- ✅ 将军 / 将死判断正确
- ✅ 核心规则逻辑与 UI / AI 解耦

---

## 7. 版本完成标志

> **“这是一个规则正确、行为可预测的中国象棋程序。”**

---

**FSD v1.0.0 End**